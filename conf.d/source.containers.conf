<source>
  type tail
  format json
  time_key time
  path /mnt/log/containers/*.log
  pos_file /mnt/pos/ggcp-containers.log.pos
  time_format %Y-%m-%dT%H:%M:%S.%NZ
  tag containers.*
  read_from_head false
</source>

<match containers.**>
  type record_reformer
  enable_ruby true
  tag kubernetes.${tag_suffix[4].split('-')[0..-2].join('.')}
  raw_tag ${tag_suffix}
  log ${record["log"].strip}
</match>

# Remove empty lines
<filter containers.**>
  @type grep
  exclude1 log "^$"
</filter>
